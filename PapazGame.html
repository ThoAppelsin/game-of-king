<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <title>Papaz the Game</title> <meta name="description" content="Papaz the Game"> <meta name="author" content="Utkan Gezer"> <style>body{ font-family:'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;font-size:9px;}.active::before{ content:"> ";}.active::after{ content:" <";}#speedslider{ display:block;width:100%;}#speedlabel{ display:block;width:100%;text-align:center;font-size:200%;}#scoretable{ border:collapse;table-layout:fixed;width:100%;}#scoretable>td{ width:100%;}.cardtable{ width:100%;position:relative;}.cardtable>tbody{ margin:0;position:absolute;left:50%;margin-right:-50%;transform:translate(-50%, 0);}.cardtable td:nth-child(1){ text-align:right;}.cardtable td:nth-child(2){ text-align:left;}.cardtable td:nth-child(2)::before{ content:"of ";color:gray;}.cardtable td:nth-child(2)::after{ content:"s";}</style> </head> <body> <input id="speedslider" type="range" min="1" max="15" value="2" autofocus> <label id="speedlabel" for="speedslider"></label> <table id="scoretable"> <tr><th id="leftheader">Left</th><th>Pile</th><th id="rightheader">Right</th></tr> <tr> <td><table id="left" class="cardtable"><tbody></tbody></table></td> <td><table id="pile" class="cardtable"><tbody></tbody></table></td> <td><table id="right" class="cardtable"><tbody></tbody></table></td> </tr> </table> <script>function Card(t,e){this.suit=t,this.rank=e}function Deck(){var t,e;this.cards=[];for(t in SuitsEnum)if(SuitsEnum.hasOwnProperty(t))for(e in RanksEnum)RanksEnum.hasOwnProperty(e)&&this.cards.push(new Card(SuitsEnum[t],RanksEnum[e]));this.shuffle()}function textdraw(t,e,r){function n(t){for(var e=document.createElement("tbody"),r=0;r<t.length;r++)e.appendChild(t[r].row());return e}function a(t){for(var e=document.createElement("tbody"),r=t.length-1;r>=0;r--){var n=t[r],a=n.row();n.rank==RanksEnum.rk&&(a.style.color="#E55"),e.appendChild(a)}return e}var s=[document.getElementById("leftheader"),document.getElementById("rightheader")],i=document.getElementById("left"),o=document.getElementById("pile"),u=document.getElementById("right");s[r].className="active",s[1-r].className="",i.replaceChild(a(t[0]),i.firstChild),o.replaceChild(n(e),o.firstChild),u.replaceChild(a(t[1]),u.firstChild)}function redraw(t,e,r){textdraw(t,e,r)}function sliderstopToSpeedfactor(t){return 1<=t?t*(t-1)/4+.5:1}function timeout(t){var e=1e3;return e/t}function papazgame(){function t(t){var r=sliderstopToSpeedfactor(n.value),a=document.getElementById("speedlabel");a.innerHTML="x"+r.toFixed(2),d={tout:setTimeout(e,timeout(r)-(t?t:0)),ms:Date.now()}}function e(){function e(){Array.prototype.splice.apply(i[o],[0,0].concat(u.reverse())),u.length=0}r=1-o;var n=i[o].pop();if(void 0===n){if(!u.length)return void(a=r);e(),n=i[o].pop()}var s=u.last();u.push(n),n.takes(s)&&e(),o=r,redraw(i,u,o),t()}var r,n=document.getElementById("speedslider"),a=null,s=new Deck,i=s.halfSplit(),o=0,u=[];redraw(i,u,o);var d=null;n.oninput=function(e){null!==d&&(clearTimeout(d.tout),t(Date.now()-d.ms))},t()}function main(){papazgame()}Array.prototype.last=function(){return this[this.length-1]};var SuitsEnum=Object.freeze({spade:{str:"Spade"},heart:{str:"Heart"},diamond:{str:"Diamond"},club:{str:"Club"}}),RanksEnum=Object.freeze({ra:{str:"Ace"},r2:{str:"2"},r3:{str:"3"},r4:{str:"4"},r5:{str:"5"},r6:{str:"6"},r7:{str:"7"},r8:{str:"8"},r9:{str:"9"},r10:{str:"10"},rj:{str:"Jack"},rq:{str:"Queen"},rk:{str:"King"}});Card.prototype.takes=function(t){return!(!t||!t.hasOwnProperty("rank"))&&(this.rank===RanksEnum.rk||this.rank===t.rank)},Card.prototype.str=function(){return this.rank.str+" of "+this.suit.str+"s"},Card.prototype.row=function(){var t=document.createElement("tr"),e=document.createElement("td");e.innerHTML=this.rank.str;var r=document.createElement("td");return r.innerHTML=this.suit.str,t.appendChild(e),t.appendChild(r),t},Deck.prototype.shuffle=function(){for(var t,e,r=this.cards.length;0!==r;)e=Math.floor(Math.random()*r),r-=1,t=this.cards[r],this.cards[r]=this.cards[e],this.cards[e]=t},Deck.prototype.halfSplit=function(){return halfCount=Math.trunc(this.cards.length/2),[this.cards.slice(0,halfCount),this.cards.slice(halfCount)]},main();</script> </body> </html>
